<!DOCTYPE html>
<html>
    <head>
        <title>
            Dynamically build FT survey
        </title>
    <style>
	    html, body {
	        height: 100%;
	        margin: 0px;
	        padding: 0px
	    }
      	.survey {
      		background-color: pink;
      	}
      	.chapter {
      		background-color: blue;
        	min-height: 100px;
      		width: 200px;
      		margin: 10px;
	        padding: 10px
      	}	
      	.question{
      		background-color: green;
        	min-height: 80px;
      		width: 80px;
      		margin: 10px;
	        padding: 10px
      	}
      	.questionsContainerDIV{
      		background-color: black;
      		min-heightheight: 60px;
      		min-width: 60px;
      		margin: 10px;
	        padding: 10px
      	}
      	.chaptersContainerDIV{
      		background-color: yellow;
      		overflow: hidden
      	}
      	.chapterContainerDIV{
      		background-color: green;
      		margin: 2px;
	        padding: 2px;
	        position: relative;
   			float: left;
      	}
    </style>
    <body>
    	<div id="survey_container"></div>
  	</body>
    <script language="javascript">
    	var surveyView = new surveyView(new survey);
    	document.getElementsByTagName('body')[0].appendChild(surveyView.getView());
    	// Here be the Views
    	// !!/!T(&"#("/!(/T#")(/!=)/"=)(!)(YEU!")/H)"(UWE=")!"(!=)(!=#)(=))))
		function surveyView(survey){
			this.survey = survey;
			var chapterViews = []; // Instances of chapters
			var div = document.createElement('div');
			div.className = "survey";
			var addChapterButton = document.createElement("button");
			addChapterButton.innerHTML = 'Add Chapter';
			var that = this;
			addChapterButton.onclick = function(){
            	that.addChapter(new chapter());
        	}
			div.appendChild(addChapterButton);
			var chaptersContainerDIV = document.createElement('div');
         	chaptersContainerDIV.className = "chaptersContainerDIV";
			this.getView = function(){
				return div;
			}
			this.addChapter = function(chapter){
				if(survey.getChapterCount() == 0){
					div.appendChild(chaptersContainerDIV);
				}
				var chapterContainerDIV = document.createElement('div');
         		chapterContainerDIV.className = "chapterContainerDIV";
				var newChapterView = new chapterView(chapter);
				survey.addChapter(chapter);
				chapterViews.push(newChapterView);
				var newChapterDIV = chapterViews[chapterViews.length-1].getView();
				chapterContainerDIV.appendChild(newChapterDIV);
				var eraseChapterButton = document.createElement("button");
				eraseChapterButton.innerHTML = 'Erase chapter';
				var that = this;
				chapterContainerDIV.appendChild(eraseChapterButton);
				chaptersContainerDIV.appendChild(chapterContainerDIV);
				eraseChapterButton.onclick = function(){
            		that.eraseChapter(chapterContainerDIV);
        		}
			};
			this.eraseChapter = function(chapterDIV){
				var parentChilds = chapterDIV.parentNode.childNodes;
				for (var i=0; i < parentChilds.length; i++){
					if (parentChilds[i] == chapterDIV){
						chapterViews.splice(i,1);
						break
					}
				}
				chaptersContainerDIV.removeChild(chapterDIV);
			}	
		}
		function chapterView(chapter) {
			this.chapter = chapter;
		  	var questionViews = []; //Array of question Views objects
		  	var div = document.createElement('div');
			div.className = "chapter";
			var addQuestionButton = document.createElement("button");
			addQuestionButton.innerHTML = 'Add Question';
			var that = this;
			addQuestionButton.onclick = function(){
				that.addQuestion(new question());
         	}
         	div.appendChild(addQuestionButton);
         	var questionsContainerDIV = document.createElement('div');
         	questionsContainerDIV.className = "questionsContainerDIV";
			this.getView = function(){
				return div;
			}
			this.addQuestion = function(question){
				if(chapter.getQuestionCount() == 0){
					div.appendChild(questionsContainerDIV);
				}
				newQuestionView = new questionView(question);
				chapter.addQuestion(question);
				questionViews.push(newQuestionView);
				questionsContainerDIV.appendChild(newQuestionView.getView());
			}
			this.eraseQuestion = function(questionDIV){
				chaptersContainerDIV.removeChild(chapterDIV);
			}	
		};
		function questionView(question) {
			this.question = question;
			var div = document.createElement('div');
			div.className = "question";
			this.getView = function(){
				return div;
			}
		};

		///"&)(!/=)"!/=)/"!?/((/&(&%"!(&/=")/)"!(??"!)"=)?/")!=/!&"/!&?#&*)
		function answer() {
			var answerText = null; // String
			var jumpID = null; // String
			function getAnswerText() {
				return answerText;
			};
			function setAnswerText(answerText) {
				this.answerText = answerText;
			};
			function getJumpID() {
				return jumpID;
			};
			function setjumpID(jumpID) {
				this.jumpID = jumpID;
			};
		};

		function question() {
			var type; // Instance of question type
			var loopQuestions = []; // Question instances inside this question.
			var questionText; // String
			var answers = []; // Answer instances
			var questionID; // String
			var otherEnabled; // Boolean 
			var jumpID; // String
			function getType() {
				return type;
			};
			function setType(type) {
				this.type = type;
			};
			function getQuestionText() {
				return questionText;
			};
			function setQuestionText(questionText) {
				this.questionText = questionText;
			};
			function getAnswers() {
				return answers;
			};
			function setAnswers(answers) {
				this.answers = answers;
			};
			function getJumpID() {
				return jumpID;
			};
			function setjumpID(jumpID) {
				this.jumpID = jumpID;
			};
			function getQuestionID() {
				return questionID;
			};
			function setQuestionID(questionID) {
				this.questionID = questionID;
			};
			function isOtherEnabled() {
				return otherEnabled;
			};
			function setOtherEnabled(otherEnabled) {
				this.otherEnabled = otherEnabled;
			};
			function getLoopQuestions() {
				return loopQuestions;
			};
			function setLoopQuestions(loopQuestions) {
				this.loopQuestions = loopQuestions;
			};
		};
		function questionType(){
			var MULTIPLE_CHOICE = "MC";
			var OPEN_NUMBER = "ON";
			var OPEN_TEXT = "OT";
			var IMAGE = "IM";
			var CHECKBOX = "CB";
			var ORDERED = "OL";
			var LOOP = "LP";
		};
		function chapter() {
		  	var title; // String
		  	var questions = []; //Array of question objects
         	function getChapterPosition() {
		    	return chapterPosition;
			};
			function setChapterPosition(chapterPosition) {
				this.chapterPosition = chapterPosition;
			};
		  	function getTitle() {
		    	return title;
			};
			function setTitle(title) {
				this.title = title;
			};
			function getQuestions() {
				return questions;
			};
			function setQuestions(questions) {
				this.questions = questions;
			};
			this.getDIV = function(){
				return div;
			}
			this.addQuestion = function(newQuestion){
				questions.push(newQuestion);
			}
			this.getQuestionCount = function() {
				if (questions == null){
					return 0
				} else {
					return questions.length;
				}
  			}
		};
		function survey(){
			var chapters = []; // Instances of chapters
			var fusionTableID = "seee"; // String

			function getfusionTableID() {
				return fusionTableID;
			};
			function setfusionTableID(fusionTableID) {
				this.fusionTableID = fusionTableID;
			};
			this.getChapters = function() {
				return chapters;
			};
			function setChapters(chapters) {
				this.chapters = chapters;
			};
			this.getDIV = function(){
				return div;
			}
			this.addChapter = function(newChapter){
				chapters.push(newChapter);
			}
			this.getChapterCount = function() {
				if (chapters == null){
					return 0
				} else {
					return chapters.length;
				}
  			}
		};
		function tracker(){
			var questions // Instances of questions
			var fusionTableID; // String
			function getfusionTableID() {
				return fusionTableID;
			};
			function setfusionTableID(fusionTableID) {
				this.fusionTableID = fusionTableID;
			};
			function getQuestions() {
			    return questions;
			};
			function setQuestions(questions) {
				this.questions = questions;
			};
		};
	</script>
</html>